
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>2.2.1. LAB 1 – CREATE A TRANSPARENT FORWARD PROXY SSLO &#8212; F5 SSL Orchestrator  documentation</title>
    
    <link rel="stylesheet" href="../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/f5_agility_theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/f5.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2.2.2. LAB 2 – CREATE A GATEWAY REVERSE PROXY SSLO" href="../lab2/lab2.html" />
    <link rel="prev" title="2. Class - F5 SSL Orchestrator" href="../class1.html" />
<!--
# Copyright 2017 F5 Networks
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
-->
<link href="https://cdn.f5.com/favicon.ico" rel="icon">
<script src="https://use.fontawesome.com/21fb8a09c3.js"></script>
<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>
  <body>
  <nav class="navbar navbar-default navbar-fixed-top">
  <div class="container-fluid">
    <div class="row corp-header">
      <div class="container corp-header">
        <div class="container corp-menu">
          <ul>
            <li><a href="https://f5.com" class="internalLink">F5.com</a></li>
            <li><a href="https://support.f5.com">Support</a></li>
            <li><a href="https://devcentral.f5.com">Community</a></li>
            <li><a href="https://github.com/F5Networks">GitHub</a></li>
            <li><a href="https://f5.com/about-us/careers">Careers</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="row pageHeader">
      <div class="container stat">
        <div class="col-xs-12 stat">
          <a class="internalLink" href="https://f5.com">
            <img class="logo" src="https://cdn.f5.com/websites/support/assets/images/logo.svg" width="50" height="44" alt="F5 Networks" title="F5 Networks" border="0">
          </a>
            <ul id="MainMenu" class="main-menu">
              <li>
                <a href="#">Products
                  <span class="indicator"><span class="arrow-up"></span></span>
                </a>

                <div class="menu-panel soft-hide" id="ProductsSubmenu">
                  <div class="container">
                    <ul class="submenu col-sm-11">
                      <li class="third"><span class="a-mm-h">Connectors</span>
                        <ul>
                          <li><a href="http://clouddocs.f5.com/products/connectors/marathon-bigip-ctlr/latest" data-link-type="Nav: Mega">F5 Marathon BIG-IP Controller</a></li>
                          <li><a href="http://clouddocs.f5.com/products/connectors/marathon-asp-ctlr/latest" data-link-type="Nav: Mega">F5 Marathon ASP Controller</a></li>
                          <li><a href="http://clouddocs.f5.com/products/connectors/k8s-bigip-ctlr/latest" data-link-type="Nav: Mega">F5 Kubernetes BIG-IP Controller</a></li>
                          <li><a href="http://clouddocs.f5.com/products/connectors/f5-kube-proxy/latest" data-link-type="Nav: Mega">F5 Kubernetes Proxy</a></li>
                        </ul>
                        <!--span class="seemore"><a data-link-type="Nav: Mega" href="/products/connectors">See all </a></--span-->
                      </li>
                      <li class="divider"></li>
                      <li class="third"><span class="a-mm-h">Application Service Proxy</span>
                        <ul>
                          <li><a href="http://clouddocs.f5.com/products/asp/latest" data-link-type="Nav: Mega">F5 Application Service Proxy</a></li>
                        </ul>
                        <!--span class="seemore"><a href="/products/">See all </a></span-->
                      </li>
                    </ul>
                  </div>
                </div>
              </li>
              <li>
                <a href="#">Container Integrations
                  <span class="indicator"><span class="arrow-up"></span></span>
                </a>

                <div class="menu-panel soft-hide" id="ContainersSubmenu">
                  <div class="container">
                    <ul class="submenu col-sm-11">
                      <li class="third"><span class="a-mm-h">Container Integrations</span>
                        <ul>
                          <li><a href="http://clouddocs.f5.com/containers/latest/marathon/" data-link-type="Nav: Mega">Mesos Marathon</a></li>
                          <li><a href="http://clouddocs.f5.com/containers/latest/kubernetes/" data-link-type="Nav: Mega">Kubernetes</a></li>
                          <li><a href="http://clouddocs.f5.com/containers/latest/openshift/" data-link-type="Nav: Mega">RedHat OpenShift</a></li>
                        </ul>
                        <span class="seemore"><a data-link-type="Nav: Mega" href="http://clouddocs.f5.com/containers/latest">View details </a></span>
                      </li>
                    </ul>
                  </div>
                </div>
              </li>
              <li>
                <a href="#">Clouds
                  <span class="indicator"><span class="arrow-up"></span></span>
                </a>

                <div class="menu-panel soft-hide" id="CloudsSubmenu">
                  <div class="container">
                    <ul class="submenu col-sm-11">
                      <li class="third"><span class="a-mm-h">Cloud Integrations</span>
                        <ul>
                          <li><a href="http://clouddocs.f5.com/cloud/openstack/" data-link-type="Nav: Mega">OpenStack</a></li>
                        </ul>
                        <!--span class="seemore"><a data-link-type="Nav: Mega" href="/cloud/">See all </a></span-->
                      </li>
                    </ul>
                  </div>
                </div>
              </li>
              <li>
                <a href="#">Resources
                  <span class="indicator"><span class="arrow-up"></span></span>
                </a>
                <div class="menu-panel soft-hide" id="UPCProgramSubmenu">
                  <div class="container">
                    <ul class="submenu col-sm-11">
                      <li class="third">
                        <span class="a-mm-h">Downloads</span>
                        <ul>
                          <li><a target="_blank" data-link-type="Nav: Mega" href="https://hub.docker.com/r/f5networks/" class="internalLink">Docker Hub</a></li>
                          <li><a target="_blank" data-link-type="Nav: Mega" href="https://store.docker.com/images/f5networks" class="internalLink">Docker Store</a></li>
                        </ul>
                      </li>
                      <li class="divider"></li>

                      <li class="third">
                        <span class="a-mm-h">OpenSource</span>
                        <ul>
                          <li><a target="_blank" data-link-type="Nav: Mega" href="https://github.com/F5Networks" class="internalLink">GitHub</a></li>
                        </ul>
                      </li>
                      <li class="divider"></li>

                      <li class="third">
                        <a href="//university.f5.com" class="a-mm-h internalLink" target="_blank" data-link-type="Nav: Mega">F5 University</a>
                        <ul>
                          <li>
                            <p>Get up to speed with free self-paced courses</p>
                          </li>
                        </ul>
                        <a data-ng-href="https://devcentral.f5.com" class="a-mm-h internalLink" target="_blank" data-link-type="Nav: Mega" href="https://devcentral.f5.com">DevCentral</a>
                        <ul>
                          <li>
                            <p>Join the community of 250,000+ technical peers</p>
                          </li>
                        </ul>
                      </li>
                    </ul>
                  </div>
                </div>
              </li>
            </ul>
        </div>
      </div>
    </div>
  </div> <!-- /container-fluid -->
</nav>

  <div class="container-fluid">
    <div class="row">
      <div class="col-sm-3 col-md-3 sidebar">
         <h4><a href="../../">F5 SSL Orchestrator </a></h4>
<div id="searchbox" style="display: none" role="search">
  <form class="search" action="../../search.html" method="get">
    <div>
      <input type="text" name="q" placeholder="Search" style="padding-left: 6px;"/>
      <!-- <input type="submit" value="Go" style="margin-top: 4px;"/> -->
      <button type="submit" class="btn btn-primary btn-xs">Go</button>
    </div>
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <p class="caption">
   <span class="caption-text">Current Page</span>
  </p>
  <ul>
<li><a class="reference internal" href="#">2.2.1. LAB 1 – CREATE A TRANSPARENT FORWARD PROXY SSLO</a><ul>
<li><a class="reference internal" href="#step-1-review-the-lab-environment-and-map-out-the-services-and-endpoints">2.2.1.1. Step 1: Review the lab environment and map out the services and endpoints</a></li>
<li><a class="reference internal" href="#step-2-fulfill-the-ssl-orchestrator-prerequisites">2.2.1.2. Step 2: Fulfill the SSL Orchestrator prerequisites</a></li>
<li><a class="reference internal" href="#step-3-create-the-ssl-orchestrator-deployment-through-guided-configuration">2.2.1.3. Step 3: Create the SSL Orchestrator deployment through Guided Configuration</a></li>
<li><a class="reference internal" href="#step-4-test-the-solution">2.2.1.4. Step 4: Test the solution</a></li>
</ul>
</li>
</ul>


<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">1. Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../class1.html">2. Class - F5 SSL Orchestrator</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../class1.html"
                        title="previous chapter">2. Class - F5 SSL Orchestrator</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../lab2/lab2.html"
                        title="next chapter">2.2.2. LAB 2 – CREATE A GATEWAY REVERSE PROXY SSLO</a></p>
        
      </div>
      <div class="col-md-offset-3 col-sm-offset-3 main">
        <h4>
          <a href="/">Community Training Classes &amp; Labs</a> &gt; <a href="../../index.html">F5 SSL Orchestrator</a>
          <span class="right"><a href="../../genindex.html">Index</a></span>
        </h4>
        
  <div class="section" id="lab-1-create-a-transparent-forward-proxy-sslo">
<h1>2.2.1. LAB 1 – CREATE A TRANSPARENT FORWARD PROXY SSLO<a class="headerlink" href="#lab-1-create-a-transparent-forward-proxy-sslo" title="Permalink to this headline">¶</a></h1>
<p>The majority of enterprise forward proxy configurations will involve
a single F5 platform performing the SSL visibility task. The SSL
Orchestrator has been designed with that principle in mind and
performs robust security service chaining of security devices
attached to a single appliance. SSL Orchestrator 5.0 now makes
configuration of a single-box deployment simple and intuitive.
Please follow the steps below to create a transparent forward proxy
SSL Orchestrator configuration.</p>
<div class="section" id="step-1-review-the-lab-environment-and-map-out-the-services-and-endpoints">
<h2>2.2.1.1. Step 1: Review the lab environment and map out the services and endpoints<a class="headerlink" href="#step-1-review-the-lab-environment-and-map-out-the-services-and-endpoints" title="Permalink to this headline">¶</a></h2>
<p>Review the “SSL Orchestrator Lab Environment” section. This
lab will attach one of each type of security service (HTTP, ICAP,
L2, L3, TAP) to SSLO for an outbound forward proxy traffic flow.
Afterwards, an internal client will be able to access remote
(Internet) resources through SSLO, providing decrypted, inspectable
traffic to the security services.</p>
<ul>
<li><p class="first">The client is attached to a <em>10.20.0.0/24</em> network and is assigned
the IP <em>10.20.0.60</em>. This network is attached to the BIG-IP 1.1
interface.</p>
</li>
<li><p class="first">The <strong>L2 device</strong> is an Ubuntu 14.04 LTS server configured to bridge
its eth1 and eth2 interfaces. Its inbound VLAN (traffic to it) is
attached to the BIG-IP <em>1.6</em> interface. Its outbound interface
(traffic coming from it) is attached to the BIG-IP <em>1.7</em> interface.</p>
</li>
<li><p class="first">The <strong>L3 device</strong> is an Ubuntu 14.04 LTS server configured to route
between its eth1.10 and eth1.20 (tagged) interfaces. Its inbound VLAN
(traffic to it) is attached to the BIG-IP <em>1.3 (VLAN tag 30)</em>
interface and has an IP of <em>198.19.64.64/25</em>. Its outbound interface
(traffic coming from it) is attached to the BIG-IP <em>1.3 (VLAN tag
60)</em> interface and has an IP of <em>198.19.64.130/25</em>. Its default
gateway is <em>198.19.64.245</em>, which will be a VLAN self-IP on the
BIG-IP.</p>
</li>
<li><p class="first">The <strong>TAP</strong> device is an Ubuntu 14.04 LTS server configured with a
single eth1 interface. That interface is attached to the BIG-IP <em>1.4</em>
interface.</p>
</li>
<li><p class="first">The <strong>DLP/ICAP</strong> device is an Ubuntu 14.04 LTS server configured with
a single eth1 interface. That interface is attached to the BIG-IP
<em>1.5</em> interface and has an IP of <em>10.70.0.10 and listening on port
1344</em>. The box is running c-icap and Squid/Clamav.</p>
</li>
<li><p class="first">The <strong>Explicit Proxy device</strong> is an Ubuntu 14.04 LTS server
configured with Squid. Its interfaces are eth1.30 and eth1.40
(tagged). Its inbound VLAN (traffic to it) is attached to the BIG-IP
<em>1.3 (VLAN tag 110)</em> interface and has an IP of <em>198.19.96.66/25</em>.
Its outbound interface (traffic coming from it) is attached to the
BIG-IP</p>
<p><em>1.3 (VLAN tag 120)</em> interface and has an IP of <em>198.19.96.136/25</em>.
Its default gateway is <em>198.19.96.245</em>, which will be a VLAN self-IP
on the BIG-IP.</p>
</li>
<li><p class="first">The outbound network is attached to the BIG-IP <em>1.2</em> interface, in
the <em>10.30.0.0/24</em> subnet, and has a gateway of <em>10.30.0.1</em>.</p>
</li>
<li><p class="first">In the lab, client inbound, Internet outbound, and DLP VLANs and
self-IPs are already created.</p>
</li>
</ul>
</div>
<div class="section" id="step-2-fulfill-the-ssl-orchestrator-prerequisites">
<h2>2.2.1.2. Step 2: Fulfill the SSL Orchestrator prerequisites<a class="headerlink" href="#step-2-fulfill-the-ssl-orchestrator-prerequisites" title="Permalink to this headline">¶</a></h2>
<p>There are a number of objects that SSL Orchestrator does not create
and expects to exist before deploying the iApp. You must create the
following objects before starting the iApp:</p>
<ul class="simple">
<li><strong>Import the CA certificate and private key</strong> – in order to terminate
and re-encrypt outbound SSL traffic, SSL Forward Proxy must re-issue,
or rather “forge” a new server certificate to the client. In order to
perform this re-issuance process, the BIG-IP must possess a
certificate authority (CA) certificate and associated private key.
<em>This lab environment already has a subordinate CA certificate and
private key installed</em>.</li>
<li><strong>Create the client inbound VLAN and self-IP</strong> – create the VLAN and
self-IP that connects the client to the BIG-IP. In this lab that’s
the <em>10.20.0.0/24</em> subnet and interface <em>1.1</em> on the BIG-IP. This lab
environment already has this VLAN and self-IP created.</li>
<li><strong>Create the Internet outbound VLAN and self-IP</strong> – create the VLAN
and self-IP that connects the BIG-IP to the outbound Internet router.
In this lab that’s the <em>10.30.0.0/24</em> subnet and interface <em>1.2</em> on
the BIG-IP. <em>This lab environment already has this VLAN and self-IP
created</em>.</li>
<li><strong>Create the DLP VLAN and self-IP</strong> – if it is desired to isolate the
DLP/ICAP device, create the VLAN and self- IP that connects the DLP
device to the BIG-IP. In this lab that’s the <em>10.70.0.0/24</em> subnet
and interface <em>1.5</em> on the BIG-IP. The DLP security device is
listening on <em>10.70.0.10</em> and ICAP is listening on port <em>1344</em>. <em>This
lab environment already has this VLAN and self-IP created</em>.</li>
<li><strong>Create the default internet route for outbound traffic</strong> – the iApp
provides an option to leverage a defined gateway pool or use the
system default route. If a gateway pool is not used, they system
route table will need to have a default route used to reach Internet
destination. <em>We’ll use a gateway pool defined within SSLO to create
this Route</em>.</li>
</ul>
</div>
<div class="section" id="step-3-create-the-ssl-orchestrator-deployment-through-guided-configuration">
<h2>2.2.1.3. Step 3: Create the SSL Orchestrator deployment through Guided Configuration<a class="headerlink" href="#step-3-create-the-ssl-orchestrator-deployment-through-guided-configuration" title="Permalink to this headline">¶</a></h2>
<p>The SSL Orchestrator Guided Configuration presents a completely new
and streamlined user experience. This workflow-based architecture
provides intuitive, re-entrant configuration steps tailored to the
selected topology.</p>
<a class="reference internal image-reference" href="../../_images/image04.png"><img alt="../../_images/image04.png" src="../../_images/image04.png" style="height: 80px;" /></a>
<p>Topology System Settings SSL Configuration Service Service Chain
Security Policy Interception Rule Summary</p>
<p>The following steps will walk through the Guided Configuration (GC)
to build a simple transparent forward proxy.</p>
<ul>
<li><p class="first"><strong>SSL Orchestrator</strong> - click on <strong>SSL Orchestrator</strong> panel then click
<strong>Configuration</strong></p>
<a class="reference internal image-reference" href="../../_images/image14.png"><img alt="../../_images/image14.png" src="../../_images/image14.png" style="height: 400px;" /></a>
</li>
<li><p class="first"><strong>Initialization</strong> – if this is the first time accessing SSLO in a
new BIG-IP build, upon first access, GC will automatically load and
deploy the built-in SSLO package.</p>
<a class="reference internal image-reference" href="../../_images/image16.jpeg"><img alt="../../_images/image16.jpeg" src="../../_images/image16.jpeg" style="height: 200px;" /></a>
</li>
<li><p class="first"><strong>Configuration review and prerequisites</strong> – take a moment to review
the topology options and workflow configuration steps involved.
Optionally satisfy any of the DNS, NTP and Route prerequisites from
this page. Keep in mind, however, that aside from NTP, the SSLO GC
will provide an opportunity to define DNS and route settings later in
the workflow. No other configurations are required on this page, so
click Next.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">DNS and NTP settings have already been defined in this lab.</p>
</div>
<a class="reference internal image-reference" href="../../_images/image17.png"><img alt="../../_images/image17.png" src="../../_images/image17.png" style="height: 400px;" /></a>
<a class="reference internal image-reference" href="../../_images/image18.png"><img alt="../../_images/image18.png" src="../../_images/image18.png" style="height: 80px;" /></a>
</li>
<li><p class="first"><strong>Topology Properties</strong> – SSLO now creates <em>discreet</em> configurations
based on the selected topology. For example, in previous versions of
SSLO, a transparent and explicit forward proxy might be defined
together. In SSLO 5.0, these are configured separately. An explicit
forward proxy topology will ultimately create an explicit proxy
listener and its relying transparent proxy lister, but the
transparent listener will be bound only to the explicit proxy tunnel.
If a subsequent transparent forward proxy topology is configured, it
will not overlap the existing explicit proxy objects. The Topology
Properties page provides the following options,</p>
<p>The Protocol option presents four protocol types:</p>
</li>
<li><p class="first"><strong>TCP</strong> – this option creates a single TCP wildcard interception rule
for the L3 Inbound, L3 Outbound L3, and L3 Explicit Proxy topologies.</p>
</li>
<li><p class="first"><strong>UDP</strong> – this option creates a single UDP wildcard interception rule
for L3 Inbound and L3 Outbound topologies.</p>
</li>
<li><p class="first"><strong>Other</strong> – this option creates a single any protocol wildcard
interception rule for L3 Inbound and L3 Outbound topologies,
typically used for non-TCP/UDP traffic flows.</p>
</li>
<li><p class="first"><strong>Any</strong> – this option creates the TCP, UDP and non-TCP/UDP
interception rules for outbound traffic flows.</p>
<p>The SSL Orchestrator Topologies option page presents six topologies:</p>
<ul class="simple">
<li><strong>L3 Explicit Proxy</strong> – this is the traditional explicit forward proxy.</li>
<li><strong>L3 Outbound</strong> – this is the traditional transparent forward proxy.</li>
<li><strong>L3 Inbound</strong> – this is a reverse proxy “gateway” configuration. In
its simplest form, this topology builds an SSLO environment designed
to sit <strong>*in front of*</strong> another ADC or routed path. Advanced options
allow it to define a pool for more directed traffic flow, but alone
does not provide the same flexibility afforded a typical LTM reverse
proxy virtual server. It also must perform re-encryption on egress.
The primary use case for this topology is as a gateway SSL visibility
solution, potentially sitting at a boundary edge in front of multiple
internal ADC environments.</li>
<li><strong>L2 Inbound</strong> – the layer 2 topology options insert SSLO as a
bump-in-the-wire in an existing routed path, where SSLO presents no
IP addresses on its outer edges. The L2 Inbound topology provides a
transparent path for inbound traffic flows.</li>
<li><strong>L2 Outbound</strong> – the layer 2 topology options insert SSLO as a
bump-in-the-wire in an existing routed path, where SSLO presents no
IP addresses on its outer edges. The L2 Outbound topology provides a
transparent path for outbound traffic flows.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is important to distinguish    SSLO’s layer 2 topology from those of
other traditional layer 2 SSL visibility vendors.  “True” layer 2
solutions like Blue Coat’s SSL visibility appliance (SSLVA) limit the
types of devices that can be inserted into the inspection zone to
layer 2 and below, and devices must be directly connected to the
appliance.  SSLO’s layer 2 topology only exists at the outer edges.
Inside the inspection zone, full-proxy routing is still happening,
so layer 3 and HTTP services can still function normally.</p>
</div>
<ul class="simple">
<li><strong>Existing Application</strong> – this topology is designed to work with
existing LTM applications. Whereas the L3 Inbound topology provides
an inbound gateway function for SSLO, Existing Application works with
LTM virtual servers that already perform their own SSL handling and
client-server traffic management. The Existing Application workflow
proceeds directly to service creation and security policy definition,
then exits with an SSLO-type access policy and per-request policy
that can easily be consumed by an LTM virtual server.</li>
</ul>
<a class="reference internal image-reference" href="../../_images/image19.jpeg"><img alt="../../_images/image19.jpeg" src="../../_images/image19.jpeg" style="height: 100px;" /></a>
<a class="reference internal image-reference" href="../../_images/image20.png"><img alt="../../_images/image20.png" src="../../_images/image20.png" style="height: 500px;" /></a>
</li>
</ul>
<p>For this lab,</p>
<ul>
<li><p class="first"><strong>Name</strong>: Outbound_demo</p>
</li>
<li><p class="first"><strong>Protocol</strong>: Any – this will create separate TCP, UDP and
non-TCP/UDP interception rules.</p>
</li>
<li><p class="first"><strong>IP Family</strong>: IPv4</p>
</li>
<li><p class="first"><strong>Topology</strong>: L3 Outbound</p>
</li>
<li><p class="first">Click Save &amp; Next.</p>
<a class="reference internal image-reference" href="../../_images/image21.png"><img alt="../../_images/image21.png" src="../../_images/image21.png" style="height: 400px;" /></a>
<a class="reference internal image-reference" href="../../_images/image22.png"><img alt="../../_images/image22.png" src="../../_images/image22.png" style="height: 60px;" /></a>
</li>
<li><p class="first"><strong>SSL Configurations</strong> – this page defines the specific SSL settings
for the selected topology, in this case a forward proxy, and controls
both client-side and server-side SSL options. If existing SSL
settings are available (from a previous workflow), it can be selected
and re-used. Otherwise the SSL Configurations page creates new SSL
settings for this workflow. For this lab, create a new SSL profile,</p>
<ul>
<li><p class="first">Click on Show Advance Settings</p>
<a class="reference internal image-reference" href="../../_images/image23.png"><img alt="../../_images/image23.png" src="../../_images/image23.png" style="height: 200px;" /></a>
</li>
<li><p class="first">Client-side SSL</p>
<ul class="simple">
<li><strong>Cipher Type</strong> – cipher type can be a Cipher Group or Cipher
String. If the former, select a previously-defined cipher group
(from Local Traffic – Ciphers – Groups). If the latter, enter a
cipher string that appropriately represents the client-side TLS
requirement. For most environments, DEFAULT is optimal. For this
lab, lease Cipher String selected.</li>
<li><strong>Certificate Key Chain</strong> – the certificate key chain represents
the certificate and private key used as the “template” for forged
server certificates. While re-issuing server certificates
on-the-fly is generally easy, private key creation tends to be a
CPU-intensive operation. For that reason, the underlying SSL
Forward Proxy engine forges server certificates from a single
defined private key. This setting gives customers the opportunity
to apply their own template private key, and optionally store that
key in a FIPS-certified HSM for additional protection. The
built-in “default” certificate and private key uses 2K RSA and is
generated from scratch when the BIG-IP system is installed. The
pre-defined default.crt and default.key can be left as is. Click
Done.</li>
<li><strong>CA Certificate Key Chain</strong> – an SSL forward proxy must re-sign,
or “forge” remote server certificate to local clients using a
local certificate authority (CA) certificate, and local clients
must trust this local CA. This setting defines the local CA
certificate and private key used to perform the forging operation.
Click the pencil icon to Edit, then select subca.f5demolabs.com
for both Certificate and Key, and click Done.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">SSL Settings minimally require RSA-based template and CA certificates
but can also support Elliptic Curve (ECDSA) certificates.  In this
case, SSLO would forge and EC certificate to the client if the TLS
handshake negotiated an ECDHE_ECDSA cipher.  To enable EC forging
support, add both an EC template certificate and key, and ECCA
certificates and key.</p>
</div>
<a class="reference internal image-reference" href="../../_images/image24.png"><img alt="../../_images/image24.png" src="../../_images/image24.png" style="height: 300px;" /></a>
<ul class="simple">
<li><strong>[Advanced] Bypass on Handshake Alert</strong> – this setting allows the
underlying SSL Forward Proxy process to bypass SSL decryption if an
SSL handshake error is detected on the server side. It is recommended
to leave this disabled.</li>
<li><strong>[Advanced] Bypass on Client Certificate Failure</strong> – this setting
allows the underlying SSL Forward Proxy process to bypass SSL
decryption if it detects a Certificate request message from the
server, as in when a server requires mutual certificate
authentication. It is recommended to leave this disabled.</li>
</ul>
<a class="reference internal image-reference" href="../../_images/image25.png"><img alt="../../_images/image25.png" src="../../_images/image25.png" style="height: 60px;" /></a>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The above two Bypass option can create a security vulnerability.
If a colluding client and server can force and SSL handshake error,
or force client certificate authentication, they can effectively
bypass SSL inspection.  It is recommended that these settings be
left disabled.</p>
</div>
</li>
<li><p class="first">Server-side SSL</p>
<ul class="simple">
<li><strong>Cipher Type</strong> – cipher type can be a Cipher Group or Cipher
String. If the former, select a previously-defined cipher group
(from Local Traffic – Ciphers – Groups). If the latter, enter a
cipher string that appropriately represents the server-side TLS
requirement. For most environments, DEFAULT is optimal.</li>
<li><strong>Trusted Certificate Authority</strong> – browser vendors routinely
update the CA certificate stores in their products to keep up with
industry security trends, and to account for new and revoked CAs.
In the SSL forward proxy use case, however, the SSL visibility
product now performs all server-side certificate validation, in
lieu of the client browser, and should therefore do its best to
maintain the <em>same</em> industry security trends. BIG-IP ships with a
CA certificate bundle that maintains a list of CA certificates
common to the browser vendors. However, a more comprehensive
bundle can be obtained from the F5 Downloads site. For this lab,
select the built-in ca-bundle.crt.</li>
<li><strong>[Advanced] Expire Certificate Response</strong> – SSLO performs
validation on remote server certificates and can control what
happens if it receives an expired server certificate. The options
are <strong>drop</strong>, which simply drops the traffic, and <strong>ignore</strong>,
which mirrors an expired forged certificate to the client. The
default and recommended behavior for forward proxy is to drop
traffic on an expired certificate.</li>
<li><strong>[Advanced] Untrusted Certificate Authority</strong> – SSLO performs
validation on remote server certificates and can control what
happens if it receives an untrusted server certificate, based on
the Trusted Certificate Authority bundle. The options are
<strong>drop</strong>, which simply drops the traffic, and <strong>ignore</strong>, which
allows the traffic and forges a good certificate to the client.
The default and recommended behavior for forward proxy is to drop
traffic on an untrusted certificate.</li>
<li><strong>[Advanced] OCSP</strong> – this setting selects an existing or can
create a new OCSP profile for server-side Online Certificate
Status Protocol (OCSP) and OCSP stapling. With this enabled, if a
client issues a Status_Request message in its ClientHello message
(an indication that it supports OCSP stapling), SSLO will issue a
corresponding Status_Request message in its server-side TLS
handshake. SSLO will then forge the returned OCSP stapling
response back to the client. If the server does not respond with a
staple but contains an Authority Info Access (AIA) field that
points to an OCSP responder URL, SSLO will perform a separate OCSP
request. The returned status is then mirrored in the stapled
client-side TLS handshake. Leave it at —SELECT—-</li>
<li><strong>[Advanced] CRL</strong> – this setting selects an existing or can
create a new CRL profile for server- side Certificate Revocation
List (CRL) validation. With this enabled, SSLO attempts to match
server certificates to locally-cached CRLs. Leave it at “—SELECT—-“</li>
</ul>
</li>
<li><p class="first">Click Save &amp; Next.</p>
<a class="reference internal image-reference" href="../../_images/image26.png"><img alt="../../_images/image26.png" src="../../_images/image26.png" style="height: 400px;" /></a>
<a class="reference internal image-reference" href="../../_images/image05.png"><img alt="../../_images/image05.png" src="../../_images/image05.png" style="height: 60px;" /></a>
</li>
</ul>
</li>
<li><p class="first"><strong>Services List</strong> – the Services List page is used to define security
services that attach to SSLO. The 5.0 SSLO Guided Configuration now
includes a services catalog that contains common product
integrations. Beneath each of these catalog options is one of the
five basic service types. The service catalog also provides “generic”
security services. Depending on screen resolution, it may be
necessary to scroll down to see additional services.</p>
<a class="reference internal image-reference" href="../../_images/image27.png"><img alt="../../_images/image27.png" src="../../_images/image27.png" style="height: 160px;" /></a>
<a class="reference internal image-reference" href="../../_images/image28.png"><img alt="../../_images/image28.png" src="../../_images/image28.png" style="height: 400px;" /></a>
<p>This lab will create one of each type of security service. Click Add Service
button, then either select a service from the catalog and click Add, or simply
double-click the service to go to its configuration page.</p>
</li>
<li><p class="first"><strong>Inline layer 2 service</strong> – select the FireEye Inline Layer 2
service from the catalog and click Add, or simply double-click the
FireEye Inline Layer 2 service, or any other Inline Layer 2 service
in the catalog.</p>
<a class="reference internal image-reference" href="../../_images/image29.png"><img alt="../../_images/image29.png" src="../../_images/image29.png" style="height: 300px;" /></a>
</li>
<li><p class="first"><strong>Name</strong> – provide a unique name to this service (example “FireEye”).</p>
</li>
<li><p class="first"><strong>Network Configuration</strong> – paths define the network interfaces that
take inspectable traffic to the inline service and receive traffic
from the service. Click Add.</p>
<ul>
<li><p class="first"><strong>Ratio</strong> – inline security services are natively load balanced,
so this setting defines a ratio, if any for the load balanced pool
members. Enter 1.</p>
</li>
<li><p class="first"><strong>From BIGIP VLAN</strong> – this is the interface taking traffic to the
inline service. Select the Create New option, enter a unique name
(ex. FireEye_in), select the F5 interface connecting to the
inbound side of the service, and add a VLAN tag value if required.
For this lab, select interface 1.6.</p>
</li>
<li><p class="first"><strong>To BIGIP VLAN</strong> – this is the interface receiving traffic from
the inline service. Select the Create New option, enter a unique
name (ex. FireEye_out), select the F5 interface connecting to the
outbound side of the service, and add a VLAN tag value if
required. For this lab, select interface 1.7.</p>
<a class="reference internal image-reference" href="../../_images/image30.png"><img alt="../../_images/image30.png" src="../../_images/image30.png" style="height: 400px;" /></a>
</li>
</ul>
</li>
<li><p class="first">Click Done.</p>
</li>
<li><p class="first"><strong>Service Action Down</strong> – SSLO also natively monitors the load
balanced pool of security devices, and if all pool members fail, can
actively bypass this service (<strong>Ignore</strong>), or stop all traffic
(<strong>Reset</strong>, <strong>Drop</strong>). For this lab, leave it set to Ignore.</p>
</li>
<li><p class="first"><strong>Enable Port Remap</strong> – this setting allows SSLO to remap the port of
HTTPS traffic flowing across this service. This is advantageous when
a security service defines port 443 traffic as encrypted HTTPS and
natively ignores it. By remapping HTTPS traffic to, say, port 8080,
the security service will inspect the traffic. For this lab, enable
(check) this option and enter a port value value (ex. 8080).</p>
</li>
<li><p class="first"><strong>iRules</strong> – SSLO now allows for the insertion of additional iRule
logic at different points. An iRule defined at the service only
affects traffic flowing across this service. It is important to
understand, however, that these iRules must not be used to control
traffic flow (ex. pools, nodes, virtuals, etc.), but rather should be
used to view/modify application layer protocol traffic. For example,
an iRule assigned here could be used to view and modify HTTP traffic
flowing to/from the service. Additional iRules are not required,
however, so leave this empty.</p>
</li>
<li><p class="first">Click Save.</p>
<a class="reference internal image-reference" href="../../_images/image31.png"><img alt="../../_images/image31.png" src="../../_images/image31.png" style="height: 300px;" /></a>
<a class="reference internal image-reference" href="../../_images/image32.png"><img alt="../../_images/image32.png" src="../../_images/image32.png" style="height: 300px;" /></a>
</li>
<li><p class="first"><strong>Inline layer 3 service</strong> – select the Generic Inline Layer 3
service from the catalog and click Add, or simply double-click the
Generic Inline Layer 3 service.</p>
<a class="reference internal image-reference" href="../../_images/image33.png"><img alt="../../_images/image33.png" src="../../_images/image33.png" style="height: 300px;" /></a>
</li>
<li><p class="first"><strong>Name</strong> – provide a unique name to this service (example “IPS”).</p>
</li>
<li><p class="first"><strong>IP Family</strong> – this setting defines the IP family used with this
layer 3 service. Leave it set to IPv4.</p>
</li>
<li><p class="first"><strong>Auto Manage Addresses</strong> – when enabled the Auto Manage Addresses
setting provides a set of unique, non-overlapping, non-routable IP
addresses to be used by the security service. If disabled, the To and
From IP addresses must be configured manually. It is recommended to
leave this option enabled (checked).</p>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In environments where SSLO is introduced to existing security devices,
it is a natural tendency to not want to have to move these devices.
And while SSLO certainly allows it, by not moving the security devices
into SSLO protect enclaves, customers run the risk of exposing sensitive
decrypted traffic, unintentionally, to other devices that may be connected
to these existing networks.  It is therefore highly recommended, and a
security best practice, to remove SSLO integrated security devices from
existing networks and place them entirely within the isolated enclave
created and maintained by SSLO.</p>
</div>
<a class="reference internal image-reference" href="../../_images/image34.png"><img alt="../../_images/image34.png" src="../../_images/image34.png" style="height: 300px;" /></a>
<ul>
<li><p class="first"><strong>To Service Configuration</strong> – the “To Service” defines the network
connectivity from SSLO to the inline security device.</p>
<ul class="simple">
<li><strong>To Service</strong> – with the Auto Manage Addresses option enabled,
this IP address will be pre-defined, therefore the inbound side of
the service must match this IP subnet. With the Auto Manage
Addresses option disabled, the IP address must be defined
manually. For this lab, leave the 198.19.64.7/25 address intact.</li>
<li><strong>VLAN</strong> – select the Create New option, provide a unique name
(ex. IPS_in), select the F5 interface connecting to the inbound
side of the service, and add a VLAN tag value if required. For
this lab, select interface 1.3 and VLAN tag 50.</li>
</ul>
</li>
<li><p class="first"><strong>Service Down Action</strong> – SSLO also natively monitors the load
balanced pool of security devices, and if all pool members fail, can
actively bypass this service (<strong>Ignore</strong>), or stop all traffic
(<strong>Reset</strong>, <strong>Drop</strong>). For this lab, leave it set to Ignore.</p>
<a class="reference internal image-reference" href="../../_images/image35.png"><img alt="../../_images/image35.png" src="../../_images/image35.png" style="height: 300px;" /></a>
</li>
<li><p class="first"><strong>L3 Devices</strong> – this defines the inbound-side IP address of the
inline layer 3 service, used for routing traffic to this device.
Multiple load balanced IP addresses can be defined here. Click Add,
enter 198.19.64.64, then click Done.</p>
</li>
<li><p class="first"><strong>From Service Configuration</strong> – the “From Service” defines the
network connectivity from the inline security device to SSLO.</p>
<ul class="simple">
<li><strong>From Service</strong> – with the Auto Manage Addresses option enabled,
this IP address will be pre-defined, therefore the outbound side
of the service must match this IP subnet. With the Auto Manage
Addresses option disabled, the IP address must be defined
manually. For this lab, leave the 198.19.65.245/25 address intact.</li>
<li><strong>VLAN</strong> – select the Create New option, provide a unique name
(ex. IPS_out), select the F5 interface connecting to the outbound
side of the service, and add a VLAN tag value if required. For
this lab, select interface 1.3 and VLAN tag 60.</li>
</ul>
</li>
<li><p class="first"><strong>Enable Port Remap</strong> – this setting allows SSLO to remap the port of
HTTPS traffic flowing across this service. This is advantageous when
a security service defines port 443 traffic as encrypted HTTPS and
natively ignores it. By remapping HTTPS traffic to, say, port 8181,
the security service will inspect the traffic. For this lab, enable
(check) this option and enter a port value value (ex. 8181).</p>
</li>
<li><p class="first"><strong>Manage SNAT Settings</strong> – SSLO now defines an option to enable SNAT
(source NAT) across an inline layer 3/HTTP service. The primary use
case for this is horizontal SSLO scaling, where independent SSLO
devices are scaled behind a separate load balancer but share the same
inline layer 3/HTTP services. As these devices must route back to
SSLO, there are now multiple SSLO devices to route back to. SNAT
allows the layer 3/HTTP device to know which SSLO sent the packets
for proper routing. SSLO scaling also requires that the Auto Manage
option be disabled, to provide separate address spaces on each SSLO.
For this, leave it set to None.</p>
</li>
<li><p class="first"><strong>iRules</strong> – SSLO now allows for the insertion of additional iRule
logic at different points. An iRule defined at the service only
affects traffic flowing across this service. It is important to
understand, however, that these iRules must not be used to control
traffic flow (ex. pools, nodes, virtuals, etc.), but rather should be
used to view/modify application layer protocol traffic. For example,
an iRule assigned here could be used to view and modify HTTP traffic
flowing to/from the service. Additional iRules are not required,
however, so leave this empty.</p>
</li>
<li><p class="first">Click Save.</p>
<a class="reference internal image-reference" href="../../_images/image36.png"><img alt="../../_images/image36.png" src="../../_images/image36.png" style="height: 400px;" /></a>
</li>
<li><p class="first"><strong>Inline HTTP service</strong> – an inline HTTP service is defined as an
explicit or transparent proxy for HTTP (web) traffic. Select the WSA
HTTP Proxy service from the catalog and click Add, or simply double-
click the WSA HTTP Proxy service, or any other HTTP Proxy service in
the catalog.</p>
<a class="reference internal image-reference" href="../../_images/image37.png"><img alt="../../_images/image37.png" src="../../_images/image37.png" style="height: 300px;" /></a>
</li>
<li><p class="first"><strong>Name</strong> – provide a unique name to this service (example “Proxy”).</p>
</li>
<li><p class="first"><strong>IP Family</strong> – this setting defines the IP family used with this
layer 3 service. Leave it set to IPv4.</p>
</li>
<li><p class="first"><strong>Auto Manage Addresses</strong> – when enabled the Auto Manage Addresses
setting provides a set of unique, non-overlapping, non-routable IP
addresses to be used by the security service. If disabled, the To and
From IP addresses must be configured manually. It is recommended to
leave this option enabled (checked).</p>
</li>
<li><p class="first"><strong>Proxy Type</strong> – this defines the proxy mode that the inline HTTP
service is in. For this lab, set this option to Explicit.</p>
</li>
<li><p class="first"><strong>To Service Configuration</strong> – the “To Service” defines the network
connectivity from SSLO to the inline security device.</p>
<ul class="simple">
<li><strong>To Service</strong> – with the Auto Manage Addresses option enabled,
this IP address will be pre-defined, therefore the inbound side of
the service must match this IP subnet. With the Auto Manage
Addresses option disabled, the IP address must be defined
manually. For this lab, leave the 198.19.96.7/25 address intact.</li>
<li><strong>VLAN</strong> – select the Create New option, provide a unique name
(ex. Proxy_in), select the F5 interface connecting to the inbound
side of the service, and add a VLAN tag value if required. For
this lab, select interface 1.3 and VLAN tag 110.</li>
</ul>
</li>
<li><p class="first"><strong>Service Down Action</strong> – SSLO also natively monitors the load
balanced pool of security devices, and if all pool members fail, can
actively bypass this service (<strong>Ignore</strong>), or stop all traffic
(<strong>Reset</strong>, <strong>Drop</strong>). For this lab, leave it set to Ignore.</p>
<a class="reference internal image-reference" href="../../_images/image38.png"><img alt="../../_images/image38.png" src="../../_images/image38.png" style="height: 300px;" /></a>
</li>
<li><p class="first"><strong>HTTP Proxy Devices</strong> – this defines the inbound-side IP address of
the inline HTTP service, used for passing traffic to this device.
Multiple load balanced IP addresses can be defined here. For a
transparent proxy HTTP service, only an IP address is required. For
an explicit proxy HTTP service, the IP address and listening port is
required. Click Add, enter 198.19.96.66 for the IP Address, and 3128
for the Port, then click Done.</p>
</li>
<li><p class="first"><strong>From Service Configuration</strong> – the “From Service” defines the
network connectivity from the inline security device to SSLO.</p>
<ul class="simple">
<li><strong>From Service</strong> – with the Auto Manage Addresses option enabled,
this IP address will be pre-defined, therefore the outbound side
of the service must match this IP subnet. With the Auto Manage
Addresses option disabled, the IP address must be defined
manually. For this lab, leave the 198.19.96.245/25 address intact.</li>
<li><strong>VLAN</strong> – select the Create New option, provide a unique name
(ex. Proxy_out), select the F5 interface connecting to the
outbound side of the service, and add a VLAN tag value if
required. For this lab, select interface 1.3 and VLAN tag 120.</li>
</ul>
</li>
<li><p class="first"><strong>Manage SNAT Settings</strong> – SSLO now defines an option to enable SNAT
(source NAT) across an inline layer 3/HTTP service. The primary use
case for this is horizontal SSLO scaling, where independent SSLO
devices are scaled behind a separate load balancer but share the same
inline layer 3/HTTP services. As these devices must route back to
SSLO, there are now multiple SSLO devices to route back to. SNAT
allows the layer 3/HTTP device to know which SSLO sent the packets
for proper routing. SSLO scaling also requires that the Auto Manage
option be disabled, to provide separate address spaces on each SSLO.
For this, leave it set to None.</p>
</li>
<li><p class="first"><strong>Authentication Offload</strong> – when an Access authentication profile is
attached to an explicit forward proxy topology, this option will
present the authenticated username value to the service as an
X-Authenticated-User HTTP header. For this lab, leave it disabled
(unchecked).</p>
</li>
<li><p class="first"><strong>iRules</strong> – SSLO now allows for the insertion of additional iRule
logic at different points. An iRule defined at the service only
affects traffic flowing across this service. It is important to
understand, however, that these iRules must not be used to control
traffic flow (ex. pools, nodes, virtuals, etc.), but rather should be
used to view/modify application layer protocol traffic. For example,
an iRule assigned here could be used to view and modify HTTP traffic
flowing to/from the service. Additional iRules are not required,
however, so leave this empty.</p>
</li>
<li><p class="first">Click Save.</p>
<a class="reference internal image-reference" href="../../_images/image39.png"><img alt="../../_images/image39.png" src="../../_images/image39.png" style="height: 300px;" /></a>
</li>
<li><p class="first"><strong>ICAP service</strong> – an ICAP service is an RFC 3507-defined service
that provides some set of services over the ICAP protocol. Select the
Digital Guardian ICAP service from the catalog and click Add, or
simply double-click the Digital Guardian ICAP service, or any other
ICAP service in the catalog.</p>
<a class="reference internal image-reference" href="../../_images/image40.png"><img alt="../../_images/image40.png" src="../../_images/image40.png" style="height: 300px;" /></a>
</li>
<li><p class="first"><strong>Name</strong> – provide a unique name to this service (example “DLP”).</p>
</li>
<li><p class="first"><strong>IP Family</strong> – this setting defines the IP family used with this
layer 3 service. Leave it set to IPv4.</p>
</li>
<li><p class="first"><strong>ICAP Devices</strong> – this defines the IP address of the ICAP service,
used for passing traffic to this device. Multiple load balanced IP
addresses can be defined here. Click Add, enter <strong>10.70.0.10</strong> for
the IP Address, and <strong>1344</strong> for the Port, and then click Done.</p>
</li>
<li><p class="first"><strong>ICAP Headers</strong> – select either <strong>Default</strong> or <strong>Custom</strong> to specify
additional ICAP headers. To add custom headers, select Custom,
otherwise leave as Default.</p>
<a class="reference internal image-reference" href="../../_images/image41.png"><img alt="../../_images/image41.png" src="../../_images/image41.png" style="height: 300px;" /></a>
</li>
<li><p class="first"><strong>OneConnect</strong> – the F5 OneConnect profile improves performance by
reusing TCP connections to ICAP servers to process multiple
transactions. If the ICAP servers do not support multiple ICAP
transactions per TCP connection, do not enable this option. For this
lab, leave the OneConnect setting enabled.</p>
</li>
<li><p class="first"><strong>Request URI Path</strong> – this is the RFC 3507-defined URI request path
to the ICAP service. Each ICAP security vendor will differ with
respect to request and response URIs, and preview length, so it is
important to review the vendor’s documentation. In this lab, enter <strong>/squidclamav</strong>.</p>
</li>
<li><p class="first"><strong>Response URI Path</strong> – this is the RFC 3507-defined URI response
path to the ICAP service. Each ICAP security vendor will differ with
respect to request and response URIs, and preview length, so it is
important to review the vendor’s documentation. In this lab, enter <strong>/squidclamav</strong>.</p>
</li>
<li><p class="first"><strong>Preview Max Length(bytes)</strong> – this defines the maximum length of
the ICAP preview. Each ICAP security vendor will differ with respect
to request and response URIs, and preview length, so it is important
to review the vendor’s documentation. A zero-length preview length
implies that data will be streamed to the ICAP service, similar to an
HTTP 100/Expect process, while any positive integer preview length
defines the amount of data (in bytes) that are transmitted first,
before streaming the remaining content. The ICAP service in this lab
environment does not support a complete stream, so requires a modest
amount of initial preview. In this lab, enter 524288.</p>
</li>
<li><p class="first"><strong>Service Down Action</strong> – SSLO also natively monitors the load
balanced pool of security devices, and if all pool members fail, can
actively bypass this service (<strong>Ignore</strong>), or stop all traffic
(<strong>Reset</strong>, <strong>Drop</strong>). For this lab, leave it set to Ignore.</p>
</li>
<li><p class="first"><strong>HTTP Version</strong> – this defines whether SSLO sends HTTP/1.1 and
HTTP/1.0 requests to the ICAP service.</p>
</li>
<li><p class="first"><strong>ICAP Policy</strong> – an ICAP policy is a pre-defined LTM CPM policy that
can be configured to control access to the ICAP service based on
attributes of the HTTP request or response. ICAP processing is
enabled by default, so an ICAP CPM policy can be used to disable the
request and/or response ADAPT profiles.</p>
</li>
<li><p class="first">Click Save.</p>
<a class="reference internal image-reference" href="../../_images/image42.png"><img alt="../../_images/image42.png" src="../../_images/image42.png" style="height: 300px;" /></a>
</li>
<li><p class="first"><strong>TAP service</strong> – a TAP service is a passive device that simply
receives a copy of traffic. Select the Cisco Sourcefire TAP service
from the catalog and click Add, or simply Double-click the Cisco
Sourcefire TAP service, or any other TAP service in the catalog.</p>
<a class="reference internal image-reference" href="../../_images/image43.png"><img alt="../../_images/image43.png" src="../../_images/image43.png" style="height: 200px;" /></a>
</li>
<li><p class="first"><strong>Name</strong> - provide a unique name to this service (example “TAP”).</p>
</li>
<li><p class="first"><strong>Mac Address</strong> – for a tap service that is not directly connected to
the F5, enter the device’s MAC address. For a tap service that is
directly connected to the F5, the MAC address does not matter and can
be arbitrarily defined. For this lab, enter 12:12:12:12:12:12.</p>
</li>
<li><p class="first"><strong>VLAN</strong> – this defines the interface connecting the F5 to the TAP
service. Click Create New and provide a unique name (ex. TAP_in).</p>
</li>
<li><p class="first"><strong>Interface</strong> – select the 1.4 interface.</p>
</li>
<li><p class="first"><strong>Enable Port Remap</strong> – this setting allows SSLO to remap the port of
HTTPS traffic flowing to this service. For this lab, leave the option
disabled (unchecked).</p>
</li>
<li><p class="first">Click Save.</p>
</li>
<li><p class="first">Click Save &amp; Next.</p>
<a class="reference internal image-reference" href="../../_images/image44.png"><img alt="../../_images/image44.png" src="../../_images/image44.png" style="height: 400px;" /></a>
<a class="reference internal image-reference" href="../../_images/image45.png"><img alt="../../_images/image45.png" src="../../_images/image45.png" style="height: 400px;" /></a>
<a class="reference internal image-reference" href="../../_images/image46.png"><img alt="../../_images/image46.png" src="../../_images/image46.png" style="height: 60px;" /></a>
</li>
<li><p class="first"><strong>Service Chain List</strong> – service chains are arbitrarily-ordered lists
of security devices. Based on environmental requirements, different
service chains may contain different re-used sets of services, and
different types of traffic can be assigned to different service
chains. For example, HTTP traffic may need to go through all of the
security services, while non-HTTP traffic goes through a subset, and
traffic destined to a financial service URL can bypass decryption and
still flow through a smaller set of security services.</p>
<a class="reference internal image-reference" href="../../_images/image06.png"><img alt="../../_images/image06.png" src="../../_images/image06.png" style="height: 100px;" /></a>
<a class="reference internal image-reference" href="../../_images/image47.png"><img alt="../../_images/image47.png" src="../../_images/image47.png" style="height: 300px;" /></a>
</li>
<li><p class="first">Click Add to create a new service chain containing all of the
security services.</p>
</li>
<li><p class="first"><strong>Name</strong> – provide a unique name to this service (ex.
“my_service_chain”).</p>
</li>
<li><p class="first"><strong>Services</strong> – select any number of desired service and move them
into the <strong>Selected Service Chain Order</strong> column, optionally also
ordering them as required. In this lab, select all of the services.</p>
</li>
<li><p class="first">Click Save.</p>
<a class="reference internal image-reference" href="../../_images/image48.png"><img alt="../../_images/image48.png" src="../../_images/image48.png" style="height: 300px;" /></a>
</li>
<li><p class="first">Click Add to create a new service chain for just the L2 (ex. FireEye)
and TAP services.</p>
<ul class="simple">
<li><strong>Name</strong> – provide a unique name to this service (ex.
“my_sub_service_chain”).</li>
<li><strong>Services</strong> – select the inline layer 2 ssloS_FireEye and
ssloS_TAP services.</li>
<li>Click Save.</li>
</ul>
<a class="reference internal image-reference" href="../../_images/image49.png"><img alt="../../_images/image49.png" src="../../_images/image49.png" style="height: 300px;" /></a>
</li>
<li><p class="first">Click Save &amp; Next</p>
<a class="reference internal image-reference" href="../../_images/image50.png"><img alt="../../_images/image50.png" src="../../_images/image50.png" style="height: 300px;" /></a>
<a class="reference internal image-reference" href="../../_images/image51.png"><img alt="../../_images/image51.png" src="../../_images/image51.png" style="height: 60px;" /></a>
</li>
<li><p class="first"><strong>Security Policy</strong> – security policies are the set of rules that
govern how traffic is processed in SSLO. The “actions” a rule can
take include,</p>
<ul class="simple">
<li>Whether or not to allow the traffic</li>
<li>Whether or not to decrypt the traffic</li>
<li>Which service chain (if any) to pass the traffic through</li>
</ul>
<p>The SSLO Guided Configuration presents an intuitive rule-based,
drag-and-drop user interface for the definition of security policies.</p>
<a class="reference internal image-reference" href="../../_images/image52.png"><img alt="../../_images/image52.png" src="../../_images/image52.png" style="height: 100px;" /></a>
<p>In the background, SSLO maintains these security policies as visual
per-request policies. If traffic processing is required that exceeds
the capabilities of the rule-based user interface, the underlying
per-request policy can be managed directly.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Once the per-request policy is manipulated, the rules-based interface
can no longer be used.</p>
</div>
<p>For the lab, create an additional rule to bypass SSL for “Financial
Data and Services” and “Health and Medicine” URL categories.</p>
<ul>
<li><p class="first">Click Add to create a new rule.</p>
<ul>
<li><p class="first"><strong>Name</strong> – provide a unique name for the rule (ex. “urlf_bypass”).</p>
</li>
<li><p class="first">Conditions</p>
<ul class="simple">
<li>Select <strong>HTTP Connect Catagory</strong></li>
<li><strong>Category Lookup (All)</strong> – add Financial Data and Services and
Health and Medicine.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The Category Lookup (ALL) condition provides categorization for
TLS SNI, HTTP Connect and HTTP Host information.</p>
</div>
</li>
<li><p class="first"><strong>Action</strong> – select Allow.</p>
</li>
<li><p class="first"><strong>Service Chain</strong> – select the ssloSC_my_sub_service_chain
L2/TAP service chain.</p>
</li>
<li><p class="first">Click OK.</p>
<a class="reference internal image-reference" href="../../_images/image53.png"><img alt="../../_images/image53.png" src="../../_images/image53.png" style="height: 150px;" /></a>
</li>
</ul>
<p>Notice in the list of rules that the <strong>All Traffic</strong> rule intercepts
but does not send traffic to a service chain. For the lab, edit this
rule to send all intercepted traffic to a service chain.</p>
<ul>
<li><p class="first">Click the pencil icon to edit this rule.</p>
</li>
<li><p class="first">Service Chain – select the service chain containing all of the services.</p>
</li>
<li><p class="first">Click OK.</p>
<a class="reference internal image-reference" href="../../_images/image55.jpeg"><img alt="../../_images/image55.jpeg" src="../../_images/image55.jpeg" style="height: 150px;" /></a>
</li>
<li><p class="first">Click Save &amp; Next.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../_images/image55.png"><img alt="../../_images/image55.png" src="../../_images/image55.png" style="height: 60px;" /></a>
</div></blockquote>
</li>
</ul>
</li>
</ul>
</li>
<li><p class="first"><strong>Interception Rule</strong> – interception rules are based on the selected
topology and define the “listeners”, analogous to LTM virtual
servers, that accept and process different types of traffic (ex. TCP,
UDP, other). The resulting LTM virtual servers will bind the SSL
settings, VLANs, IPs, and security policies created in the topology
workflow.</p>
<ul>
<li><p class="first"><strong>Ingress Network (VLANs)</strong> – this defines the VLANs through which
traffic will enter. For a transparent forward proxy topology, this
would be a client-side VLAN. Select client-net.</p>
</li>
<li><p class="first"><strong>L7 Interception Rules</strong> – FTP and email protocol traffic are all
“server-speaks-first” protocols, and therefore SSLO must process
these separately from typical client-speaks-first protocols like
HTTP. This selection enables processing of each of these
protocols, which create separate port-based listeners for each. As
required, selectively enable the additional protocols that need to
be decrypted and inspected through SSLO. Select FTP, IMAP, POP3
and SMTP</p>
</li>
<li><p class="first">Click Save &amp; Next.</p>
<a class="reference internal image-reference" href="../../_images/image56.png"><img alt="../../_images/image56.png" src="../../_images/image56.png" style="height: 300px;" /></a>
<a class="reference internal image-reference" href="../../_images/image55.png"><img alt="../../_images/image55.png" src="../../_images/image55.png" style="height: 60px;" /></a>
</li>
</ul>
<p><strong>Egress Setting</strong> – traffic egress settings are now defined
per-topology and manage both the gateway route and outbound SNAT settings.</p>
</li>
<li><p class="first"><strong>Manage SNAT Settings</strong> – enables per-topology instance SNAT
settings. For this lab, select Auto Map.</p>
</li>
<li><p class="first"><strong>Gateways</strong> – enables per-topology instance gateway routing. Options
are to use the system default route, to use an existing gateway pool,
or to create a new gateway. For this lab, select Create New.</p>
</li>
<li><p class="first"><strong>IPv4 Outbound Gateways</strong> – when creating a new gateway, this
section provides the ratio and gateway address settings.</p>
</li>
<li><p class="first"><strong>Ratio</strong> – multiple gateway IP addresses are load balanced in an LTM
pool, and the ratio setting allows SSLO to proportion traffic to the
gateway members, as required. A ratio on 1 for all members evenly
distributes the load across them. For this lab, select 1.</p>
</li>
<li><p class="first"><strong>Address</strong> – this is the next hop gateway IP address. For this lab,
enter 10.30.0.1.</p>
</li>
<li><p class="first">Click Save &amp; Next.</p>
</li>
</ul>
<a class="reference internal image-reference" href="../../_images/image07.png"><img alt="../../_images/image07.png" src="../../_images/image07.png" style="height: 60px;" /></a>
<ul>
<li><p class="first"><strong>Summary</strong> – the summary page presents an expandable list of all of
the workflow-configured objects. To expand the details for any given
setting, click the corresponding arrow icon on the far right. To edit
any given setting, click the corresponding pencil icon. Clicking the
pencil icon will send the workflow back to the selected settings
page.</p>
<ul class="simple">
<li>When satisfied with the defined settings, click Deploy.</li>
</ul>
<p>Upon successfully deploying the configuration, SSL Orchestrator will
now display a <strong>Dashboard</strong> view</p>
<a class="reference internal image-reference" href="../../_images/image57.jpeg"><img alt="../../_images/image57.jpeg" src="../../_images/image57.jpeg" style="height: 400px;" /></a>
<p>The <strong>Interception Rules</strong> tab shows the listeners that were created
per the selected topology.</p>
<a class="reference internal image-reference" href="../../_images/image58.png"><img alt="../../_images/image58.png" src="../../_images/image58.png" style="height: 400px;" /></a>
<p>In the above,</p>
</li>
<li><p class="first">The <strong>-in-t-4</strong> listener defines normal TCP IPv4 traffic.</p>
</li>
<li><p class="first">The <strong>-in-u-4</strong> listener defines normal UDP IPv4 traffic.</p>
</li>
<li><p class="first">The <strong>-ot-4</strong> listener defines normal non-TCP/non-UDP IPv4 traffic.</p>
</li>
<li><dl class="first docutils">
<dt>The <strong>-ftp</strong>, <strong>-ftps</strong>, <strong>-pop3</strong>, <strong>-smtp25</strong> and <strong>-smtp587</strong></dt>
<dd><p class="first last">listeners create paths for each respective protocol.</p>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="step-4-test-the-solution">
<h2>2.2.1.4. Step 4: Test the solution<a class="headerlink" href="#step-4-test-the-solution" title="Permalink to this headline">¶</a></h2>
<p>To test the deployed solution, use the following options:</p>
<ul>
<li><p class="first">Server certificate test</p>
<p>Open a browser on the client system and navigate to any
remote HTTPS site, for example,
<a class="reference external" href="http://www.google.com/">*https://www.google.com*</a>
Once the site opens in the browser, check the server certificate of
the site and verify that it has been issued by the local CA
configured in SSLO. This confirms that the SSL forward proxy
functionality enabled by SSL Orchestrator is working correctly.</p>
<a class="reference internal image-reference" href="../../_images/image60.jpeg"><img alt="../../_images/image60.jpeg" src="../../_images/image60.jpeg" style="height: 200px;" /></a>
</li>
<li><p class="first">Decrypted traffic analysis on the F5</p>
<p>Perform a tcpdump on the F5 system to observe the decrypted clear
text traffic. This confirms SSL interception by SSLO.</p>
<p><strong>tcpdump -lnni [interface or VLAN name] -Xs0</strong></p>
<p>As a function of adding a new service, the UI requires a name for
each (source and destination) network. SSL Orchestrator will then
create separate source and destination VLANs for inline security
devices, and those VLANs will be encapsulated within separate
application service paths. For example, given an inline layer 2
service named “FireEye” with its “From BIGIP VLAN”
named “<strong>FireEye_in</strong>”, and its “To BIGIP VLAN” named
“<strong>FireEye_out</strong>”, its corresponding BIG-IP VLANs would be
accessible via the following syntax:</p>
<p><strong>*ssloN_</strong> + [network name] + <strong>.app/ssloN_</strong> + [network name]*</p>
<p>Example: <em>ssloN_FireEye_in.app/ssloN_FireEye_in
ssloN_FireEye_in.app/ssloN_FireEye_in</em></p>
<p>A tcpdump on the source side VLAN of this FireEye service would
therefore look like this:</p>
<p><strong>tcpdump -lnni ssloN_FireEye_in.app/ssloN_FireEye_in -Xs0</strong></p>
<p>The security service VLANs and their corresponding application
services are all visible from the BIG-IP UI under Network -&gt; VLANs.</p>
</li>
<li><p class="first">Decrypted traffic analysis on the security services</p>
<p>Depending on the type of security service, it may easier to log into
the console shell and run a similar tcpdump capture on the inbound
or outbound interface, to tail its capture logs, or to log into its
management UI and capture analytics. A tcpdump capture usually
requires root or sudo access.</p>
<p><strong>tcpdump -lnni [inerface] -Xs0</strong></p>
</li>
</ul>
</div>
</div>


        
		     <div class="row next-prev-btn-row">
           <div class="col-lg-12">
           
		        <a href="../class1.html" title="2. Class - F5 SSL Orchestrator" accesskey="p" class="btn btn-primary pull-left"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous</a>
           
           
              <a href="../lab2/lab2.html" title="2.2.2. LAB 2 – CREATE A GATEWAY REVERSE PROXY SSLO" accesskey="n" class="btn btn-primary pull-right">Next <i class="fa fa-arrow-circle-right" aria-hidden="true"></i></a>
           
		     </div>
         </div>
        
      </div>
    </div>
  </div>


  <footer>
      <div class="container-fluid">
        <div class="row">
          <div class="content-fluid pre-footer">
            <div class="blocks-container">
              <div class="block">
                <h3>Support Programs</h3>
                <p>Regionally located support centers enable F5 to provide support in a number of languages through native-speaking support engineers.</p>
                <a class="btn internalLink" data-ng-href="https://f5.com/support/support-offerings" target="_blank" href="https://f5.com/support/support-offerings">See more
                  <span class="icon-1x-right icon-new-window" data-icon="new-window">​</span>
                </a>
              </div>
              <div class="block">
                <h3>Contact Support</h3>
                <p>
                  North America: 1-888-882-7535<br>
                  Outside North America: 800-11-275-435
                </p>
                <a class="btn internalLink" data-ng-href="https://f5.com/about-us/contact#regional-support" target="_blank" href="https://f5.com/about-us/contact#regional-support">Local Support Numbers
                  <span class="icon-1x-right icon-new-window" data-icon="new-window">​</span>
                </a>
              </div>
              <div class="block">
                <h3>Feedback and Help</h3>
                <p>Have questions, suggestions, or just want to get something off your chest? Let us know.</p>
                <a class="btn" data-ui-sref="siteFeedback" target="_blank" href="https://support.f5.com/csp/siteFeedback">Leave feedback</a>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="footer">
            <div class="container">
              <div class="col-sm-3 col-md-2">
                <h4>About F5</h4>
                <ul>
                  <li><a data-ng-href="https://f5.com/about-us/contact" target="_blank" data-link-type="footer" href="https://f5.com/about-us/contact" class="internalLink">Contact F5</a>
                  </li>
                  <li><a data-ng-href="https://f5.com/about-us/careers" target="_blank" data-link-type="footer" href="https://f5.com/about-us/careers" class="internalLink">Careers</a>
                  </li>
                </ul>
              </div>
              <div class="col-sm-3 col-md-2">
                <h4>Education</h4>
                <ul>
                  <li><a data-ng-href="https://f5.com/education/training" target="_blank" data-link-type="footer" href="https://f5.com/education/training" class="internalLink">Training</a>
                  </li>
                  <li><a data-ng-href="https://f5.com/education/certification" target="_blank" data-link-type="footer" href="https://f5.com/education/certification" class="internalLink">Certification</a>
                  </li>
                  <li><a data-ng-href="https://f5.com/education/training/free-courses" target="_blank" data-link-type="footer" href="https://f5.com/education/training/free-courses" class="internalLink">Free Online Training</a>
                  </li>
                </ul>
              </div>

              <div class="col-sm-3 col-md-2">
                <h4>F5 sites</h4>
                <ul>
                <li><a data-ng-href="https://f5.com" target="_blank" data-link-type="footer" href="https://f5.com" class="internalLink">F5.com</a>
                </li>
                <li><a data-ng-href="https://devcentral.f5.com" target="_blank" data-link-type="footer" href="https://devcentral.f5.com" class="internalLink">Community</a>
                </li>
                <li><a data-ng-href="https://partners.f5.com" target="_blank" data-link-type="footer" href="https://partners.f5.com" class="internalLink">Partners</a>
                </li>
            </ul>
        </div>

        <div class="col-sm-3 col-md-2">
            <h4>Support Tasks</h4>
            <ul>
                <li><a data-ui-sref="mySupport.createServiceRequest" data-link-type="footer" href="https://support.f5.com/csp/my-support/service-request">Create Service Request </a>
                </li>
                <li><a data-ng-href="https://f5.com/about-us/contact#regional-support" target="_blank" data-link-type="footer" href="https://f5.com/about-us/contact#regional-support" class="internalLink">Contact Support</a>
                </li>
                <li><a data-ui-sref="siteFeedback" target="_blank" data-link-type="footer" href="https://support.f5.com/csp/siteFeedback">Leave feedback [+]</a>
                </li>
            </ul>
        </div>

        <div class="col-xs-12 col-md-3 right">
            <h4>Connect with us</h4>
            <ul class="social_icons">
                <li><a href="//twitter.com/f5networks" target="_blank" data-name="twitter" data-type="" data-prefix="social" data-utf="E032" title="Twitter" class="externalLink"><i class="icon-1x icon-twitter icon-inverse-circle" data-link-type="footer"></i></a></li>
                <li><a href="//www.linkedin.com/companies/f5-networks" target="_blank" class="linkedin externalLink" title="LinkedIn"><i class="icon-1x icon-linkedin icon-inverse-circle" data-link-type="footer"></i></a></li>
                <li><a href="//www.facebook.com/f5networksinc" target="_blank" class="facebook externalLink" title="Facebook"><i class="icon-1x icon-facebook icon-inverse-circle" data-link-type="footer"></i></a></li>
                <li><a href="//www.youtube.com/f5networksinc" target="_blank" class="youtube externalLink" title="YouTube"><i class="icon-1x icon-youtube icon-inverse-circle" data-link-type="footer"></i></a></li>
                <li><a data-ng-href="https://devcentral.f5.com" target="_blank" class="devcentral internalLink" title="DevCentral" href="https://devcentral.f5.com"><i class="icon-1x icon-dc-pos icon-inverse-circle" data-link-type="footer"></i></a></li>
            </ul>
        </div>

        <div class="content-fluid left">
            <div class="col-xs-12">
                <p>
                    © Copyright <span class="ng-binding">2017</span> by F5 Networks, Inc. |
                    <a data-ng-href="https://f5.com/about-us/policies" target="_blank" data-link-type="footer" href="https://f5.com/about-us/policies" class="internalLink">Policies</a> |
                    <a data-ng-href="https://f5.com/about-us/policies/trademarks" target="_blank" data-link-type="footer" href="https://f5.com/about-us/policies/trademarks" class="internalLink">Trademarks</a>
                </p>
            </div>
        </div>
    </div>
</div>
    </div>
</div>
</footer>
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script src="../../_static/js/bootstrap.min.js"></script>
  <script type="text/javascript">
    jQuery.noConflict(true)
  </script>
  </body>
</html>